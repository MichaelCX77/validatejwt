name: CI ğŸš€

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” EVENTOS QUE DISPARAM O WORKFLOW
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
on:
  push:
    branches: [develop]  # Executa o workflow quando houver push para a branch develop
  workflow_dispatch:      # Permite execuÃ§Ã£o manual via interface do GitHub Actions

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§± JOB PRINCIPAL: Provisionamento global (Infraestrutura + Deploy)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
jobs:
  global-provioner:
    # â™» ReutilizaÃ§Ã£o de workflow externo armazenado no repositÃ³rio 'infra-base'
    uses: MichaelCX77/infra-base/.github/workflows/deploy.yml@develop

    # ğŸ“¥ INPUTS PARA O WORKFLOW EXTERNO
    with:
      project_name: ${{ github.repository }}     # Nome completo do repositÃ³rio (ex: user/repo)
      repo: ${{ github.repository }}             # RepositÃ³rio onde estÃ¡ o cÃ³digo a ser implantado
      ref: ${{ github.ref_name }}                # Nome da branch ou tag que disparou o workflow

    # ğŸ” SEGREDOS NECESSÃRIOS PARA ACESSO Ã€ AWS
    secrets:
      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
      AWS_REGION: ${{ secrets.AWS_REGION }}
